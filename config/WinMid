cd C:\Users\Administrator\Desktop && if exist ##FileName## ( cd ##FileName##/agent && stop.bat && cd ../.. && rmdir /s /q ##FileName## ) else ( echo creating new file)
cd C:\Users\Administrator\Desktop && mkdir ##FileName##
cd C:\Users\Administrator\Desktop\##FileName## && Powershell (New-Object System.Net.WebClient).DownloadFile( ‘https://install.service-now.com/glide/distribution/builds/package/mid/##date##/mid.##VeRsIon##.windows.x86-64.zip',’mid-dist-##VeRsIon##-windows-x86-64.zip’) && tar.exe -xf mid-dist-##VeRsIon##-windows-x86-64.zip && cd agent && powershell -Command  "(gc config.xml) -replace 'YOUR_INSTANCE_USER_NAME_HERE','@@Username@@' -replace 'YOUR_INSTANCE_PASSWORD_HERE','$$Password$$' -replace 'https://YOUR_INSTANCE.service-now.com', 'https://##Instance##.service-now.com' -replace 'YOUR_MIDSERVER_NAME_GOES_HERE','$$midserver$$' | Out-File -encoding ASCII config.xml" && cd conf && powershell -Command   "(gc wrapper-override.conf) -replace 'snc_mid','snc_mid_$$midserver$$'  -replace 'MID Server', 'MID Server_$$midserver$$' | Out-File -encoding ASCII wrapper-override.conf"
cd C:\Users\Administrator\Desktop\##FileName##\agent && start.bat